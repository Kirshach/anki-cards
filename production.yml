version: "3.8"

services:
    vue-app:
        container_name: vue-app
        env_file:
            - .env
        ports:
          - "5173:5173"
        build:
            context: .
            dockerfile: ./Docker/Node/Dockerfile
        networks:
          - vue-app-network
        depends_on:
            - vue-app-nginx
        command: "npm run dev -- --host 0.0.0.0 --port 5173"

    vue-app-nginx:
        env_file:
          - .env
        build: 
            context: .
            dockerfile: ./Docker/Nginx/Dockerfile
        ports:
          - "80:80"
          - "443:443"
        networks:
          - vue-app-network
        volumes:
            - .:/app
            - ./Docker/Nginx/nginx.conf:/etc/nginx/templates
            - ${SSL_CERTIFICATE}:/etc/nginx/certs/cert.pem:ro
            - ${SSL_CERTIFICATE_KEY}:/etc/nginx/certs/key.pem:ro

networks:
  vue-app-network:


